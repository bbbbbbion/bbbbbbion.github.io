<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>六饼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="测试3">
<meta property="og:type" content="website">
<meta property="og:title" content="六饼">
<meta property="og:url" content="https://bbbbbbion.github.io/index.html">
<meta property="og:site_name" content="六饼">
<meta property="og:description" content="测试3">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="六饼">
<meta name="twitter:description" content="测试3">
  
    <link rel="alternative" href="/atom.xml" title="六饼" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar img 256.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">bbbbbbion</a></h1>
		</hgroup>

		
		<p class="header-subtitle">程序员也有一个艺术家梦。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">存档</a></li>
				        
							<li><a href="/photos">照片</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/3DSMax/" style="font-size: 10px;">3DSMax</a> <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/NShader/" style="font-size: 10px;">NShader</a> <a href="/tags/Shader/" style="font-size: 12.5px;">Shader</a> <a href="/tags/Unity3D/" style="font-size: 20px;">Unity3D</a> <a href="/tags/Visual-Studio/" style="font-size: 10px;">Visual Studio</a> <a href="/tags/cg/" style="font-size: 17.5px;">cg</a> <a href="/tags/lua/" style="font-size: 10px;">lua</a> <a href="/tags/ulua/" style="font-size: 10px;">ulua</a> <a href="/tags/反射/" style="font-size: 10px;">反射</a> <a href="/tags/安卓/" style="font-size: 10px;">安卓</a> <a href="/tags/小众软件/" style="font-size: 10px;">小众软件</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/插件/" style="font-size: 10px;">插件</a> <a href="/tags/操作系统使用/" style="font-size: 10px;">操作系统使用</a> <a href="/tags/沙里淘金/" style="font-size: 10px;">沙里淘金</a> <a href="/tags/热更新/" style="font-size: 12.5px;">热更新</a> <a href="/tags/编辑器扩展/" style="font-size: 10px;">编辑器扩展</a> <a href="/tags/视频/" style="font-size: 10px;">视频</a> <a href="/tags/软件安装/" style="font-size: 15px;">软件安装</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">bbbbbbion</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar img 256.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">bbbbbbion</h1>
			</hgroup>
			
			<p class="header-subtitle">程序员也有一个艺术家梦。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">存档</a></li>
		        
					<li><a href="/photos">照片</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-MemoryPool" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/MemoryPool/" class="article-date">
  	<time datetime="2016-03-06T14:47:39.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/MemoryPool/">MemoryPool</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://pastebin.com/R8afbmVm" target="_blank" rel="external">http://pastebin.com/R8afbmVm</a></p>
<pre><code><span class="comment">// MIT license - TL;DR - Do whatever you want with it, I'm not liable for what you do with it!</span>
<span class="preprocessor">#<span class="keyword">define</span> FAIL_FAST</span>
<span class="keyword">using</span> UnityEngine;
<span class="keyword">using</span> System.Collections;
<span class="keyword">using</span> System.Collections.Generic;

<span class="comment">/// &lt;summary&gt;</span>
<span class="comment">/// &lt;para&gt;Used for memory recycling of reference types, like GameObjects&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;Example usage:&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;MemoryPool&lt;GameObject&gt; memPool = new MemoryPool&lt;GameObject&gt;(); // construction&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;memPool.Setup(</span>
<span class="comment">///        ()    =&gt; Instantiate(prefab),</span>
<span class="comment">///        (obj) =&gt; { obj.SetActive(true);  },</span>
<span class="comment">///        (obj) =&gt; { obj.SetActive(false); },</span>
<span class="comment">///        (obj) =&gt; { Object.Destroy(obj);  }</span>
<span class="comment">/// );&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;GameObject gobj = memPool.Alloc();  // allocate object in pool&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;memPool.Free(gobj); // deallocate object in pool&lt;/para&gt;</span>
<span class="comment">/// &lt;para&gt;MemoryPoolItem.Destroy(gobj); // deallocate object in pool OR Object.Destroy non-MemoryPool object (for GameObjects only)&lt;/para&gt;</span>
<span class="comment">/// &lt;/summary&gt;</span>
<span class="keyword">public</span> <span class="keyword">class</span> MemoryPool&lt;T&gt; where T : <span class="keyword">class</span>
{
<span class="keyword">private</span> List&lt;T&gt; allObjects = null;
<span class="keyword">private</span> <span class="keyword">int</span> freeObjectCount = <span class="number">0</span>;

<span class="function"><span class="keyword">public</span> delegate T <span class="title">DelegateBeginLife</span><span class="params">()</span></span>;
<span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DelegateCommission</span><span class="params">(T obj)</span></span>;
<span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DelegateDecommission</span><span class="params">(T obj)</span></span>;
<span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DelegateEndLife</span><span class="params">(T obj)</span></span>;

<span class="keyword">public</span> DelegateBeginLife birth;
<span class="keyword">public</span> DelegateEndLife death;
<span class="keyword">public</span> DelegateCommission commission;
<span class="keyword">public</span> DelegateDecommission decommission;

<span class="comment">/// &lt;summary&gt;</span>
<span class="comment">/// Example usage:</span>
<span class="comment">/// &lt;para&gt;memPool.Setup(</span>
<span class="comment">///        ()    =&gt; Instantiate(prefab),</span>
<span class="comment">///        (obj) =&gt; obj.SetActive(true),</span>
<span class="comment">///        (obj) =&gt; obj.SetActive(false),</span>
<span class="comment">///        (obj) =&gt; Object.Destroy(obj)</span>
<span class="comment">/// );&lt;/para&gt;</span>
<span class="comment">/// &lt;/summary&gt;</span>
<span class="comment">/// &lt;param name="create"&gt;callback function or delegate used to create a new object of type T&lt;/param&gt;</span>
<span class="comment">/// &lt;param name="activate"&gt;callback function or delegate used to activate an object of type T&lt;/param&gt;</span>
<span class="comment">/// &lt;param name="deactivate"&gt;callback function or delegate used to de-activate an object of type T&lt;/param&gt;</span>
<span class="comment">/// &lt;param name="destroy"&gt;callback function or delegate used to destroy an object of type T&lt;/param&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Setup</span><span class="params">(DelegateBeginLife create, DelegateCommission activate, DelegateDecommission deactivate, DelegateEndLife destroy)</span>
</span>{
    birth = create; commission = activate; decommission = deactivate; death = destroy;
}

<span class="comment">/// &lt;summary&gt;Constructs and calls &lt;see cref="Setup"/&gt;&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="title">MemoryPool</span><span class="params">(DelegateBeginLife create, DelegateCommission activate, DelegateDecommission deactivate, DelegateEndLife destroy)</span>
</span>{
    Setup(create, activate, deactivate, destroy);
}

<span class="comment">/// &lt;summary&gt; Be sure to call &lt;see cref="Setup"/&gt;!&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="title">MemoryPool</span><span class="params">()</span> </span>{ }

<span class="comment">/// &lt;summary&gt;Returns an object from the memory pool, which may have just been created&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> T <span class="title">Alloc</span><span class="params">()</span>
</span>{
    T freeObject = null;
    <span class="keyword">if</span> (freeObjectCount == <span class="number">0</span>)
    {
        <span class="preprocessor">#<span class="keyword">if</span> FAIL_FAST</span>
        <span class="keyword">if</span> (birth == null) { <span class="keyword">throw</span> <span class="keyword">new</span> System.Exception(<span class="string">"Call .Setup(), and provide a create method!"</span>); }
        <span class="preprocessor">#<span class="keyword">endif</span></span>
        <span class="keyword">if</span> (allObjects == null) { allObjects = <span class="keyword">new</span> List&lt;T&gt;(); }
        freeObject = birth();
        allObjects.Add(freeObject);
        <span class="keyword">if</span> (typeof(T) == typeof(GameObject))
        {
            GameObject go = freeObject as GameObject;
            go.AddComponent&lt;MemoryPoolItem&gt;().SetPool(<span class="keyword">this</span> as MemoryPool&lt;GameObject&gt;);
        }
    }
    <span class="keyword">else</span>
    {
        freeObject = allObjects[allObjects.Count - freeObjectCount];
        freeObjectCount--;
    }
    <span class="keyword">if</span> (commission != null) { commission(freeObject); }
    <span class="keyword">return</span> freeObject;
}

<span class="comment">/// &lt;summary&gt;Which object to mark as free in the memory pool&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Free</span><span class="params">(T obj)</span>
</span>{
    <span class="keyword">int</span> indexOfObject = allObjects.IndexOf(obj);
    <span class="preprocessor">#<span class="keyword">if</span> FAIL_FAST</span>
    <span class="keyword">if</span> (indexOfObject &lt; <span class="number">0</span>) { <span class="keyword">throw</span> <span class="keyword">new</span> System.Exception(<span class="string">"woah, this isn't one of mine..."</span>); }
    <span class="keyword">if</span> (indexOfObject &gt;= (allObjects.Count - freeObjectCount)) { <span class="keyword">throw</span> <span class="keyword">new</span> System.Exception(<span class="string">"hey, you're freeing this twice..."</span>); }
    <span class="preprocessor">#<span class="keyword">endif</span></span>
    freeObjectCount++;
    <span class="keyword">int</span> beginningOfFreeList = allObjects.Count - freeObjectCount;
    allObjects[indexOfObject] = allObjects[beginningOfFreeList];
    allObjects[beginningOfFreeList] = obj;
    <span class="keyword">if</span> (decommission != null) { decommission(obj); }
}

<span class="comment">/// &lt;summary&gt;performs the given delegate on each object in the memory pool&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ForEach</span><span class="params">(DelegateCommission action)</span>
</span>{
    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; allObjects.Count; ++i) { action(allObjects[i]); }
}

<span class="comment">/// &lt;summary&gt;Destroys all objects in the pool, after deactivating each one.&lt;/summary&gt;</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeallocateAll</span><span class="params">()</span>
</span>{
    ForEach((item) =&gt; decommission(item));
    <span class="keyword">if</span> (typeof(T) == typeof(GameObject))
    {
        ForEach((item) =&gt;
        {
            GameObject go = item as GameObject;
            Object.DestroyImmediate(go.GetComponent&lt;MemoryPoolItem&gt;());
        });
    }
    <span class="keyword">if</span> (death != null) { ForEach((item) =&gt; death(item)); }
    allObjects.Clear();
}
}

<span class="keyword">public</span> <span class="keyword">class</span> MemoryPoolItem : MonoBehaviour
{
<span class="keyword">private</span> MemoryPool&lt;GameObject&gt; gameObjectPool;
<span class="function"><span class="keyword">public</span> MemoryPoolItem <span class="title">SetPool</span><span class="params">(MemoryPool&lt;GameObject&gt; pool)</span> </span>{ gameObjectPool = pool; <span class="keyword">return</span> <span class="keyword">this</span>; }
<span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">bool</span> shuttingDown = <span class="literal">false</span>;
<span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetShutdown</span><span class="params">(<span class="keyword">bool</span> sceneIsEnding)</span> </span>{ shuttingDown = sceneIsEnding; }
<span class="preprocessor">#<span class="keyword">if</span> FAIL_FAST</span>
<span class="function"><span class="keyword">void</span> <span class="title">OnApplicationQuit</span><span class="params">()</span> </span>{ SetShutdown(<span class="literal">true</span>); }
<span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span> </span>{ SetShutdown(<span class="literal">false</span>); }
<span class="function"><span class="keyword">void</span> <span class="title">OnDestroy</span><span class="params">()</span>
</span>{
    <span class="keyword">if</span> (!shuttingDown) <span class="keyword">throw</span> <span class="keyword">new</span> System.Exception(<span class="string">"Instead of Object.Destroy("</span> + gameObject + <span class="string">"), call MemoryPoolItem.Destroy("</span> + gameObject + <span class="string">")\n"</span>+ <span class="string">"When changing levels, call MemoryPoolItem.SetShutdown(true) first"</span>);
}
<span class="preprocessor">#<span class="keyword">endif</span></span>
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FreeSelf</span><span class="params">()</span> </span>{ gameObjectPool.Free(gameObject); }
<span class="comment">/// &lt;summary&gt;If the given GameObject belongs to a memory pool, mark it as free in that pool. Otherwise, Object.Destroy()&lt;/summary&gt;</span>
<span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Destroy</span><span class="params">(GameObject go)</span>
</span>{
    MemoryPoolItem i = go.GetComponent&lt;MemoryPoolItem&gt;();
    <span class="keyword">if</span> (i != null) { i.FreeSelf(); }
    <span class="keyword">else</span> { Object.Destroy(go); }
}
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Unity3D中的一些技巧总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/Unity3D中的一些技巧总结/" class="article-date">
  	<time datetime="2016-03-06T14:19:40.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/Unity3D中的一些技巧总结/">Unity3D中的一些技巧总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>以下tip来源于网络（unity wiki、unity fb、unity Twitter等）  </p>
<h1 id="1：">1：</h1><p>When you’re using Debug.Log or related methods, provide the instance of the script so you can click the log output and have the relevant object selected in editor! Debug.Log(“Test”, this);  </p>
<h1 id="2：">2：</h1><p>To remember which color means what on an axis in Unity, just remember the mnemonic: RGB = XYZ.</p>
<h1 id="3：Draw_editor_gui’s_only_in_active_scene_view">3：Draw editor gui’s only in active scene view</h1><p>If you are creating custom editors for unity but only want the gui for that editor to be drawn in the currently active scene view try this …  </p>
<pre><code><span class="keyword">if</span> <span class="params">(SceneView.mouseOverWindow.GetInstanceID<span class="params">()</span> == SceneView.currentDrawingSceneView.GetInstanceID<span class="params">()</span>)</span>
{
    this.DrawGUI<span class="params">(SceneView.currentDrawingSceneView)</span>;
}
</code></pre><h1 id="4：Execute_menu_items_from_editor_script">4：Execute menu items from editor script</h1><p>If you want to take advantage of functionality that is provided by menu commands you can useEditorApplication.ExecuteMenuItem in your editor scripts to execute them.</p>
<h1 id="5：Screen_Resolution">5：Screen Resolution</h1><p>If you need to set the screen resolution of your game via scripting check out Screen.SetResolution.</p>
<h1 id="6：Collider_manipulation">6：Collider manipulation</h1><p>Did you know that you can manipulate a game objects collider in the scene view by holding down the ‘Shift’ key. Holding shift will display the colliders control dots. Just drag the dots to adjust the collider!</p>
<h1 id="7：Running_Editor_Script_Code_on_Launch">7：Running Editor Script Code on Launch</h1><p>If you need to run some script code as soon as the editor has launched you can use the InitializeOnLoad attribute.</p>
<h1 id="8：各平台下的log文件">8：各平台下的log文件</h1><p><a href="http://docs.unity3d.com/Manual/LogFiles.html" target="_blank" rel="external">http://docs.unity3d.com/Manual/LogFiles.html</a></p>
<h1 id="9：unity的命令行参数">9：unity的命令行参数</h1><p><a href="http://docs.unity3d.com/Manual/CommandLineArguments.html" target="_blank" rel="external">http://docs.unity3d.com/Manual/CommandLineArguments.html</a></p>
<h1 id="11：Can_you_hear_me_now?">11：Can you hear me now?</h1><p>Unity provides access to the users microphone via the Microphone class.<br><a href="http://docs.unity3d.com/ScriptReference/Microphone.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/Microphone.html</a></p>
<h1 id="12：Location_awareness">12：Location awareness</h1><p>Unity provides support for location awareness such as longitude, latitude, and altitude in the LocationService class.<br><a href="http://docs.unity3d.com/ScriptReference/LocationService.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/LocationService.html</a></p>
<h1 id="13：Social_Platforms">13：Social Platforms</h1><p>Unity provides built in support for various social platforms including support for custom implementations through the Social class.<br><a href="http://docs.unity3d.com/ScriptReference/Social.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/Social.html</a></p>
<h1 id="14：Gyroscopes">14：Gyroscopes</h1><p>If the device supports it you can use the Gyroscope class to get gyroscopic information about the orientation and acceleration of the device.<br><a href="http://docs.unity3d.com/ScriptReference/Gyroscope.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/Gyroscope.html</a></p>
<h1 id="15:EditorApplication">15:EditorApplication</h1><p><a href="http://docs.unity3d.com/ScriptReference/EditorApplication.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/EditorApplication.html</a><br>场景的保存、新建、暂停等等用script模拟Editor相关操作</p>
<h1 id="16:MeshUtility-Optimize">16:MeshUtility.Optimize</h1><p>程序生成的mesh可以用这个做优化</p>
<p><a href="http://docs.unity3d.com/ScriptReference/MeshUtility.Optimize.html" target="_blank" rel="external">http://docs.unity3d.com/ScriptReference/MeshUtility.Optimize.html</a></p>
<h1 id="17:UI渐变效果">17:UI渐变效果</h1><p><a href="http://pastebin.com/dJabCfWn" target="_blank" rel="external">http://pastebin.com/dJabCfWn</a></p>
<pre><code><span class="keyword">using</span> UnityEngine;
<span class="keyword">using</span> System.Collections;
<span class="keyword">using</span> System.Collections.Generic;
<span class="keyword">using</span> UnityEngine.UI;

[AddComponentMenu(<span class="string">"UI/Effects/Gradient"</span>)]
<span class="keyword">public</span> <span class="keyword">class</span> Gradient : BaseVertexEffect {
[SerializeField]
<span class="keyword">private</span> Color32 topColor = Color.white;
[SerializeField]
<span class="keyword">private</span> Color32 bottomColor = Color.black;

<span class="function"><span class="keyword">public</span> override <span class="keyword">void</span> <span class="title">ModifyVertices</span><span class="params">(List&lt;UIVertex&gt; vertexList)</span> </span>{
    <span class="keyword">if</span> (!IsActive()) {
        <span class="keyword">return</span>;
    }

    <span class="keyword">int</span> count = vertexList.Count;
    <span class="keyword">float</span> bottomY = vertexList[<span class="number">0</span>].position.y;
    <span class="keyword">float</span> topY = vertexList[<span class="number">0</span>].position.y;

    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; count; i++) {
        <span class="keyword">float</span> y = vertexList[i].position.y;
        <span class="keyword">if</span> (y &gt; topY) {
            topY = y;
        }
        <span class="keyword">else</span> <span class="keyword">if</span> (y &lt; bottomY) {
            bottomY = y;
        }
    }

    <span class="keyword">float</span> uiElementHeight = topY - bottomY;

    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) {
        UIVertex uiVertex = vertexList[i];
        uiVertex.color = Color32.Lerp(bottomColor, topColor, (uiVertex.position.y - bottomY) / uiElementHeight);
        vertexList[i] = uiVertex;
    }
}
}
</code></pre><h1 id="18:AABB碰撞检测">18:AABB碰撞检测</h1><p><a href="http://pastebin.com/BCEgZxSf" target="_blank" rel="external">http://pastebin.com/BCEgZxSf</a></p>
<pre><code><span class="keyword">using</span> UnityEngine;
<span class="keyword">using</span> System.Collections;

<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> Aabb

{

<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">Colliding</span><span class="params">( GameObject a, GameObject b )</span>
</span>{
    Rect aBox = a.BoxToRect();
    Rect bBox = b.BoxToRect();

    <span class="comment">// Find out if these guys intersect</span>
    <span class="keyword">return</span> Intersect ( aBox, bBox );
}

<span class="comment">// This checks the intersection between two rectangles.</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">Intersect</span><span class="params">( Rect a, Rect b )</span> 
</span>{
    <span class="comment">// Basic AABB collision detection. All of these must be true for there to be a collision.</span>
    <span class="keyword">bool</span> comp1 = a.yMin &gt; b.yMax;
    <span class="keyword">bool</span> comp2 = a.yMax &lt; b.yMin;
    <span class="keyword">bool</span> comp3 = a.xMin &lt; b.xMax;
    <span class="keyword">bool</span> comp4 = a.xMax &gt; b.xMin;

    <span class="comment">// This will only return true if all are true.</span>
    <span class="keyword">return</span> comp1 &amp;&amp; comp2 &amp;&amp; comp3 &amp;&amp; comp4;
}

<span class="comment">// This converts a BoxCollider2D to a rectangle for use in determining an intersection</span>
<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Rect <span class="title">BoxToRect</span> <span class="params">( <span class="keyword">this</span> GameObject a )</span>
</span>{
    <span class="comment">// Finding the BoxCollider2D for the GameObject.</span>
    BoxCollider2D aCollider = a.GetComponent&lt;BoxCollider2D&gt; ();

    <span class="comment">// Grabbing the GameObject position, converting it to Vector2.</span>
    Vector2 aPos = a.transform.position.V2();

    <span class="comment">// Now that we have the object's worldspace location, we offset that to the BoxCollider's center</span>
    aPos += aCollider.center;
    <span class="comment">// From the center, we find the top/left corner by cutting the total height/width in half and </span>
    <span class="comment">// offset by that much</span>
    aPos.x -= aCollider.size.x/<span class="number">2</span>;
    aPos.y += aCollider.size.y/<span class="number">2</span>;

    <span class="comment">// Create a rectangle based on the top/left corner, and extending the rectangle </span>
    <span class="comment">// to the width/height</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Rect ( aPos.x, aPos.y, aCollider.size.x, -aCollider.size.y );
}

<span class="comment">// Converts a Vector 3 to Vector 2</span>
<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Vector2 <span class="title">V2</span> <span class="params">( <span class="keyword">this</span> Vector3 v )</span> 
</span>{
    <span class="comment">// Converts the Vector3 to a Vector2.</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Vector2 (v.x, v.y);
}

}
</code></pre><h1 id="19：Weapon_Sway_Unity3D">19：Weapon Sway Unity3D</h1><p><a href="http://pastebin.com/p5XagGuy" target="_blank" rel="external">http://pastebin.com/p5XagGuy</a></p>
<pre><code><span class="comment">//============================================</span>
<span class="comment">// ATTACH THIS TO WEAPON</span>
<span class="comment">//</span>
<span class="comment">// ATTACH WEAPON TO PLAYER GAMEOBJECT</span>
<span class="comment">//============================================</span>

<span class="keyword">using</span> UnityEngine;
<span class="keyword">using</span> System.Collections;

<span class="keyword">public</span> <span class="keyword">class</span> WeaponSwayScript : MonoBehaviour {
<span class="keyword">public</span> <span class="keyword">float</span> mouseSensitivity = <span class="number">10f</span>;
<span class="keyword">public</span> <span class="keyword">float</span> maxMoveAmount = <span class="number">0.5f</span>;
<span class="keyword">public</span> <span class="keyword">float</span> smoothSpeed = <span class="number">3f</span>;

<span class="keyword">private</span> Vector3 startPos;

<span class="keyword">private</span> <span class="keyword">float</span> factorX;
<span class="keyword">private</span> <span class="keyword">float</span> factorY;

<span class="keyword">public</span> <span class="keyword">bool</span> bRotate;
<span class="keyword">public</span> <span class="keyword">float</span> smoothRotationSpeed = <span class="number">2f</span>;
<span class="keyword">public</span> <span class="keyword">float</span> rotateAmount = <span class="number">45f</span>;

<span class="comment">//============================================</span>
<span class="comment">// FUNCTIONS</span>
<span class="comment">//============================================</span>

<span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
</span>{
    startPos = transform.localPosition;
}

<span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span>
</span>{
    <span class="comment">// STORE MOUSE MOVEMENT AMOUNTS, SMOOTH WITH LERP</span>
    factorX = Mathf.Lerp(factorX, -Input.GetAxis(<span class="string">"Mouse X"</span>) * mouseSensitivity, Time.deltaTime * <span class="number">10f</span>);
    factorY = Mathf.Lerp(factorY, -Input.GetAxis(<span class="string">"Mouse Y"</span>) * mouseSensitivity, Time.deltaTime * <span class="number">10f</span>);

    <span class="comment">// CLAMP LIMITS</span>
    <span class="keyword">if</span> (factorX &gt; maxMoveAmount)
        factorX = maxMoveAmount;

    <span class="keyword">if</span> (factorX &lt; -maxMoveAmount)
        factorX = -maxMoveAmount;

    <span class="keyword">if</span> (factorY &gt; maxMoveAmount)
        factorY = maxMoveAmount;

    <span class="keyword">if</span> (factorY &lt; -maxMoveAmount)
        factorY = -maxMoveAmount;

    <span class="comment">// SET TARGET POSITION (START POSITION + MOUSE MOVEMENT)</span>
    Vector3 targetPos = <span class="keyword">new</span> Vector3(startPos.x + factorX, startPos.y + factorY, startPos.z);

    <span class="comment">// APPLY POSITION TO WEAPON, SMOOTH WITH LERP</span>
    transform.localPosition = Vector3.Lerp(transform.localPosition, targetPos, smoothSpeed * Time.deltaTime);

    <span class="comment">// ROTATION</span>
    <span class="keyword">if</span> (bRotate)
    {
        <span class="keyword">float</span> tiltAroundZ = Input.GetAxis(<span class="string">"Mouse X"</span>) * rotateAmount;
        <span class="keyword">float</span> tiltAroundX = Input.GetAxis(<span class="string">"Mouse Y"</span>) * rotateAmount;
        Vector3 target = <span class="keyword">new</span> Vector3(tiltAroundX, <span class="number">0f</span>, tiltAroundZ);
        transform.localRotation = Quaternion.Slerp(transform.localRotation, Quaternion.Euler(target), Time.deltaTime * smoothRotationSpeed);
    }
}
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/奇淫技巧/">奇淫技巧</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-DES加密" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/DES加密/" class="article-date">
  	<time datetime="2016-03-06T14:02:37.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/DES加密/">DES加密</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>具体请百度，下面为封装好的类（代码细节请参考msdn）:  </p>
<pre><code><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span>DES加密算法</span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DES</span>
{
<span class="function"><span class="keyword">public</span> <span class="title">DES</span>(<span class="params"></span>)
</span>{
    <span class="comment">//</span>
    <span class="comment">//<span class="doctag">TODO:</span> 在此处添加构造函数逻辑</span>
    <span class="comment">//</span>
}

<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> 对字符进行加密</span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="pToEncrypt"&gt;</span>输入字符串<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sKey"&gt;</span>密钥，要求为8个字节共64位<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span>返回加密结果<span class="xmlDocTag">&lt;/returns&gt;</span></span>
<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="keyword">string</span> pToEncrypt, <span class="keyword">string</span> sKey</span>)
</span>{
    DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();

    <span class="keyword">byte</span>[] inputByteArray = Encoding.Default.GetBytes(pToEncrypt);
    des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
    des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);
    MemoryStream ms = <span class="keyword">new</span> MemoryStream();
    CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, des.CreateEncryptor(), CryptoStreamMode.Write);
    cs.Write(inputByteArray, <span class="number">0</span>, inputByteArray.Length);
    cs.FlushFinalBlock();
    StringBuilder ret = <span class="keyword">new</span> StringBuilder();
    <span class="keyword">foreach</span> (<span class="keyword">byte</span> b <span class="keyword">in</span> ms.ToArray())
    {
        ret.AppendFormat(<span class="string">"{0:X2} "</span>, b);
    }
    ret.ToString();
    <span class="keyword">return</span> ret.ToString();
}

<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> 对已加密字符密文解密</span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="pToDecrypt"&gt;</span>已加密字符<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sKey"&gt;</span>密钥，要求为8个字节共64位<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span>解密结果<span class="xmlDocTag">&lt;/returns&gt;</span></span>
<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="keyword">string</span> pToDecrypt, <span class="keyword">string</span> sKey</span>)
</span>{
    pToDecrypt = pToDecrypt.Replace(<span class="string">" "</span>, <span class="string">""</span>);<span class="comment">//加密后的密文两位一组，组与组之间以空格隔开</span>
                                             <span class="comment">//这里要先去除所有空格</span>

    DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();
    <span class="keyword">byte</span>[] inputByteArray = <span class="keyword">new</span> <span class="keyword">byte</span>[pToDecrypt.Length / <span class="number">2</span>];
    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; pToDecrypt.Length / <span class="number">2</span>; x++)
    {
        <span class="keyword">int</span> i = (Convert.ToInt32(pToDecrypt.Substring(x * <span class="number">2</span>, <span class="number">2</span>), <span class="number">16</span>));
        inputByteArray[x] = (<span class="keyword">byte</span>)i;
    }
    des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
    des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);
    MemoryStream ms = <span class="keyword">new</span> MemoryStream();
    CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, des.CreateDecryptor(), CryptoStreamMode.Write);
    cs.Write(inputByteArray, <span class="number">0</span>, inputByteArray.Length);
    cs.FlushFinalBlock();
    StringBuilder ret = <span class="keyword">new</span> StringBuilder();
    <span class="keyword">return</span> System.Text.Encoding.Default.GetString(ms.ToArray());
}

<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> 加密文件</span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sInputFile"&gt;</span>源文件<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sOutputFile"&gt;</span>加密过后的文件<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sKey"&gt;</span>密钥，要求为8个字节共64位<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sMsg"&gt;</span>返回信息<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span>是否成功<span class="xmlDocTag">&lt;/returns&gt;</span></span>
<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">EncryptFile</span>(<span class="params"><span class="keyword">string</span> sInputFilename, <span class="keyword">string</span> sOutputFilename, <span class="keyword">string</span> sKey, <span class="keyword">out</span> <span class="keyword">string</span> sMsg</span>)
</span>{
    <span class="keyword">bool</span> IsSuccess = <span class="keyword">true</span>;
    FileStream fsInput = <span class="keyword">null</span>;
    FileStream fsEncrypted = <span class="keyword">null</span>;
    CryptoStream cryptostream = <span class="keyword">null</span>;
    <span class="keyword">try</span>
    {
        fsInput = <span class="keyword">new</span> FileStream(sInputFilename, FileMode.Open, FileAccess.Read);
        fsEncrypted = <span class="keyword">new</span> FileStream(sOutputFilename, FileMode.Create,FileAccess.Write);
        DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();
        des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
        des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);
        ICryptoTransform desencrypt = des.CreateEncryptor();
        cryptostream = <span class="keyword">new</span> CryptoStream(fsEncrypted,
                                        desencrypt,
                                        CryptoStreamMode.Write);
        <span class="keyword">byte</span>[] bytearrayinput = <span class="keyword">new</span> <span class="keyword">byte</span>[fsInput.Length];
        fsInput.Read(bytearrayinput, <span class="number">0</span>, bytearrayinput.Length);
        cryptostream.Write(bytearrayinput, <span class="number">0</span>, bytearrayinput.Length);
        cryptostream.Close();
        fsInput.Close();
        fsEncrypted.Close();
        sMsg = <span class="string">"成功"</span>;
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="keyword">catch</span> (Exception ex)
    {
        sMsg = ex.Message;
        IsSuccess = <span class="keyword">true</span>;
    }
    <span class="keyword">finally</span>
    {
        <span class="keyword">try</span>
        {
            <span class="keyword">if</span> (cryptostream != <span class="keyword">null</span>) cryptostream.Close();
            <span class="keyword">if</span> (fsInput != <span class="keyword">null</span>) fsInput.Close();
            <span class="keyword">if</span> (fsEncrypted != <span class="keyword">null</span>) fsEncrypted.Close();
        }
        <span class="keyword">catch</span>
        {
        }
    }
    <span class="keyword">return</span> IsSuccess;
}

<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> 解密文件</span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sInputFilename"&gt;</span>输入文件（已加密文件）路径<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sOutputFilename"&gt;</span>解密后文件路径<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sKey"&gt;</span>密钥，要求为8个字节共64位<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="sMsg"&gt;</span>返回信息<span class="xmlDocTag">&lt;/param&gt;</span></span>
<span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span>是否成功<span class="xmlDocTag">&lt;/returns&gt;</span></span>
<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">DecryptFile</span>(<span class="params"><span class="keyword">string</span> sInputFilename, <span class="keyword">string</span> sOutputFilename, <span class="keyword">string</span> sKey, <span class="keyword">out</span> <span class="keyword">string</span> sMsg</span>)
</span>{
    <span class="keyword">bool</span> IsSuccess = <span class="keyword">true</span>;
    FileStream fsInput = <span class="keyword">null</span>;
    FileStream fsDecrypted = <span class="keyword">null</span>;
    CryptoStream cryptostream = <span class="keyword">null</span>;
    <span class="keyword">try</span>
    {
        fsInput = <span class="keyword">new</span> FileStream(sInputFilename, FileMode.Open, FileAccess.Read);
        fsDecrypted = <span class="keyword">new</span> FileStream(sOutputFilename, FileMode.Create, FileAccess.Write);
        DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();
        des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
        des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);
        ICryptoTransform desdecrypt = des.CreateDecryptor();
        cryptostream = <span class="keyword">new</span> CryptoStream(fsDecrypted,
                                        desdecrypt,
                                        CryptoStreamMode.Write);
        <span class="keyword">byte</span>[] bytearrayinput = <span class="keyword">new</span> <span class="keyword">byte</span>[fsInput.Length];
        fsInput.Read(bytearrayinput, <span class="number">0</span>, bytearrayinput.Length);
        cryptostream.Write(bytearrayinput, <span class="number">0</span>, bytearrayinput.Length);
        cryptostream.Close();
        fsInput.Close();
        fsDecrypted.Close();
        sMsg = <span class="string">"成功"</span>;
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="keyword">catch</span> (Exception ex)
    {
        sMsg = ex.Message;
        IsSuccess = <span class="keyword">true</span>;
    }
    <span class="keyword">finally</span>
    {
        <span class="keyword">try</span>
        {
            <span class="keyword">if</span> (cryptostream != <span class="keyword">null</span>) cryptostream.Close();
            <span class="keyword">if</span> (fsInput != <span class="keyword">null</span>) fsInput.Close();
            <span class="keyword">if</span> (fsDecrypted != <span class="keyword">null</span>) fsDecrypted.Close();
        }
        <span class="keyword">catch</span>
        {
        }
    }
    <span class="keyword">return</span> IsSuccess;
}
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C#</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Unity3D交互相关总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/Unity3D交互相关总结/" class="article-date">
  	<time datetime="2016-03-06T13:48:48.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/Unity3D交互相关总结/">Unity3D交互相关总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Input.MouseButtonDown触屏、电脑通用，只要有按下操作，不需要collider</p>
<p>NGUI 中带collider的UI是可以接受到射线检测的，不过需要注意的是</p>
<pre><code>void Update<span class="params">()</span>
{
    <span class="keyword">if</span> <span class="params">(Input.GetMouseButtonDown<span class="params">(<span class="number">0</span>)</span>)</span><span class="comment">//</span>
    {
        Ray ray = camera.ScreenPointToRay<span class="params">(Input.mousePosition)</span>;
        RaycastHit raycastHit;
        <span class="keyword">if</span> <span class="params">(Physics.Raycast<span class="params">(ray, out raycastHit)</span>)</span>
        {
            Debug.LogError<span class="params">(raycastHit.collider.name)</span>;


        }
    }
}
</code></pre><p>这里相机需要用UI相机，而不是Camera.main</p>
<p>带Collider的UI无法响应Unity自带的OnMouseDown、OnMOuseUp、OnMouseDrag事件。<br>经测试用主相机渲染的带collider的UI也无法相应上述事件</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-几种在Unity中创建AnimationCurve的方法比较" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/几种在Unity中创建AnimationCurve的方法比较/" class="article-date">
  	<time datetime="2016-03-06T12:57:45.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/几种在Unity中创建AnimationCurve的方法比较/">几种在Unity中创建AnimationCurve的方法比较</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>以下内容均在Unity4.5版本中通过</strong></p>
<h1 id="1：使用编辑器创建动画">1：使用编辑器创建动画</h1><p>假设场景中新建了一个Cube，名字为CubeTest。<br>选中该Cube, 打开Animation面板，点击AddCurve按钮,出现一个“Create New Animation”的保存框：<br><img src="/img/AnimationCurve1.png" alt="&quot;编辑器动画曲线&quot;"><br>默认情况下为Cube添加了Animator组件，<br><img src="/img/AnimationCurve2.png" alt="&quot;编辑器动画曲线&quot;"><br>同时创建了一个AnimatorController（AnimatorController的默认名字和选中的物体名字一致），一个名字为test的anim clip片段.<br><img src="/img/AnimationCurve3.png" alt="&quot;编辑器动画曲线&quot;"><br><img src="/img/AnimationCurve4.png" alt="&quot;编辑器动画曲线&quot;"><br>如图，可见Clip的属性也是和Animator中的Clip是一致的。  </p>
<p>接下来为这个Clip编辑方块在5秒钟时间内旋转52°的动画。<br><img src="/img/AnimationCurve5.png" alt="&quot;编辑器动画曲线&quot;"><br>如上图：Sample代表每秒采样的次数，图示60，则上面300代表的就是5秒时间。同时在Rotation.y处修改度数为52即可。若不使用这种方法而纯粹的通过托右边区域的红线，往往会造成误差。上图中右边区域可见黄线右边还有很多重复的灰色的线段，表示该动画是Loop循环的。若要取消该循环，可以选中该Clip，然后在Inspector面板中取消Loop Time的选项<img src="/img/AnimationCurve6.png" alt="&quot;编辑器动画曲线&quot;"> 。再刷新一下Animation面板，发现灰线消失：<br><img src="/img/AnimationCurve7.png" alt="&quot;编辑器动画曲线&quot;">  </p>
<p>若要仍使用老版本的Animation动画组件。则必须先为Cube添加Animation组件，然后再打开Animation面板-&gt;AddCurve。这个时候创建的Clip便是符合Animation组件的动画片段了。<br><img src="/img/AnimationCurve8.png" alt="&quot;编辑器动画曲线&quot;"><br>可以通过设置WrapMode来调整动画的循环方式。</p>
<h1 id="2：使用脚本创建动画">2：使用脚本创建动画</h1><p>依旧以上述Cube为例。新建一个Cube</p>
<h2 id="2-1_AnimationCurve">2.1 AnimationCurve</h2><h3 id="2-1-1编辑AnimationCurve">2.1.1编辑AnimationCurve</h3><p>新建一个脚本，拖拽到Cube上。代码如下：  </p>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">test</span> : <span class="title">MonoBehaviour</span>
{
    <span class="keyword">public</span> AnimationCurve curve;

    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)
    </span>{

    }

    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)
    </span>{

    }
}
</code></pre><p><img src="/img/AnimationCurve11.png" alt="&quot;编辑器曲线Curve&quot;"><br>点击上述红色处，便打开AnimationCurve编辑面板  </p>
<p><img src="/img/AnimationCurve12.png" alt="&quot;编辑器曲线Curve&quot;"><br>选中一种线形后，如图  </p>
<p><img src="/img/AnimationCurve13.png" alt="&quot;编辑器曲线Curve&quot;"><br>红色区域，可以选择循环的方式，包括：Loop,Clamp,Pingpang。像1中Animation编辑界面一样，这里也可以为动画线添加Key，设置弯曲等等复杂的操作。<br>最终如图，做了一个5秒，52个单位的动画，并且动画循环方式为Pingpong。下面需要用代码把Curve对应到旋转上<br><img src="/img/AnimationCurve14.png" alt="&quot;编辑器曲线Curve&quot;"><br>最终代码如下：  </p>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> test : MonoBehaviour
{
    <span class="keyword">public</span> AnimationCurve curve;

    <span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
    </span>{

    }

    <span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span>
    </span>{
        transform.eulerAngles = <span class="keyword">new</span> Vector3(<span class="number">0</span>, curve.Evaluate(Time.time), <span class="number">0</span>);
    }
}
</code></pre><h3 id="2-1-2_代码创建AnimationCurve">2.1.2 代码创建AnimationCurve</h3><p>下面使用代码来完成2.1.1中的Curve细节的创建  </p>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> test : MonoBehaviour
{
    AnimationCurve curve;

    <span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
    </span>{
        <span class="comment">//curve = AnimationCurve.Linear(0, 0, 5, 52);</span>
        curve = <span class="keyword">new</span> AnimationCurve();
        curve.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">0</span>, <span class="number">0</span>));
        curve.AddKey((<span class="keyword">new</span> Keyframe(<span class="number">5</span>, <span class="number">52</span>)));
        <span class="comment">//两种设置Curve的方式都可以。</span>
        <span class="comment">//第一个调用静态方法来设置（开始时间、开始值、结束时间、结束值 ）</span>
        <span class="comment">//第二个是先构造函数实例化Curve，然后添加Keyframe(time,value);</span>

        curve.preWrapMode = WrapMode.Clamp;
        curve.postWrapMode = WrapMode.PingPong;
    }

    <span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span>
    </span>{
        transform.eulerAngles = <span class="keyword">new</span> Vector3(<span class="number">0</span>, curve.Evaluate(Time.time), <span class="number">0</span>);
    }
}
</code></pre><h2 id="2-2_Animation">2.2 Animation</h2><p>可以发现上述2.1中动画的播放没有使用到Animation组件，而是使用的AnimationCurve. Evaluate(float time)方法来根据时间对应相对的值。<br>其实也可以使用Animation组件来播放动画，这里以2.1.2中的curve为例。<br>代码如下：  </p>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> test : MonoBehaviour
{
    <span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
    </span>{
        AnimationCurve curve = AnimationCurve.Linear(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">52</span>);         

        AnimationClip clip = <span class="keyword">new</span> AnimationClip();
        clip.wrapMode = WrapMode.Loop;
        clip.SetCurve(<span class="string">""</span>, typeof(Transform), <span class="string">"localRotation.y"</span>, curve);

        animation.AddClip(clip, <span class="string">"test"</span>);
        animation.Play(<span class="string">"test"</span>);
    }    
}
</code></pre><p>经测试不生效，表现为y rotation瞬间从0变成180。<br>把localRotation.y改成localPosition.y可行。<br>改成localScale.y也不可行。表现为localScale.x和localScale.z变成了0。然后在y上缩放。<br>具体支持的string字符串参见文档，反正是不支持诸如rotation.y之类的。<br>搞不清楚什么原因，TODO:</p>
<h1 id="3：综合实例">3：综合实例</h1><p>需要实现这样一个功能，实例化某个物体后，物体先下降，然后反弹，最后再下降到底部。<br>首先考虑到Animation编辑器，对Y轴进行编辑，结果如下  </p>
<p><img src="/img/AnimationCurve15.png" alt="&quot;编辑器曲线Curve&quot;">  </p>
<p>该图共有4个节点（0,12）,（1,3）,（1.3,12）,（3,-12）<br>然后使用该动作，问题出来了。该动作限制了Position.x为0，因此无论初始化使用这个animation clip的物体在什么地方，都会强制使得position.x变成0。<br>为了解决这个问题，必须使用程序，两套curve,一个模拟图示的曲线控制y的位置。一个用来控制x的位置为初始化位置。<br>代码如下：  </p>
<pre><code><span class="keyword">float</span> xPos;
<span class="function"><span class="keyword">void</span> <span class="title">Awake</span><span class="params">()</span>
</span>{
    xPos = transform.position.x;
}

<span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
</span>{
    <span class="comment">/*模拟Y轴上的位移动画*/</span>
    AnimationCurve curveY = <span class="keyword">new</span> AnimationCurve();
    curveY.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">0f</span>, <span class="number">12f</span>));
    curveY.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">1f</span>, <span class="number">3f</span>));
    curveY.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">1.3f</span>, <span class="number">12f</span>));
    curveY.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">3f</span>, -<span class="number">12f</span>));
    <span class="comment">//curveY.SmoothTangents(0,)//默认AddKey后，经测试程序里面就是按照布泽尔曲线拟合的</span>

    <span class="comment">/*X轴上保持初始化位置*/</span>
    AnimationCurve curveX = <span class="keyword">new</span> AnimationCurve();
    curveX.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">0f</span>, xPos));
    curveX.AddKey(<span class="keyword">new</span> Keyframe(<span class="number">3f</span>, xPos));

    <span class="comment">/*添加自毁函数*/</span>
    AnimationEvent aniEvent = <span class="keyword">new</span> AnimationEvent();
    aniEvent.functionName = <span class="string">"DestroySelf"</span>;
    aniEvent.time = <span class="number">3f</span>;

    AnimationClip clip = <span class="keyword">new</span> AnimationClip();
    clip.wrapMode = WrapMode.Once;
    clip.AddEvent(aniEvent);
    clip.SetCurve(<span class="string">""</span>, typeof(Transform), <span class="string">"localPosition.y"</span>, curveY);
    clip.SetCurve(<span class="string">""</span>, typeof(Transform), <span class="string">"localPosition.x"</span>, curveX);
    animation.AddClip(clip, <span class="string">"supplyAnimation"</span>);
    animation.Play(<span class="string">"supplyAnimation"</span>);

}

<span class="function"><span class="keyword">void</span> <span class="title">DestroySelf</span><span class="params">()</span>
</span>{
    Destroy(gameObject);
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Unity3D中的多线程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/Unity3D中的多线程/" class="article-date">
  	<time datetime="2016-03-06T12:44:41.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/Unity3D中的多线程/">Unity3D中的多线程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/img/thread1.png" alt="&quot;Unity3D多线程&quot;"><br>如上图，通过开启一个子线程来打印，这样打印窗口既不会造成堵塞（即不会挂起后蜂涌打印，而是很平滑的依次循环打印），也不会造成update中的堵塞。<br>问题来了，若退出程序，子线程仍然在工作的话，就应该关闭子线程。网上有说设置IsBackground属性为true，可以在主线程退出时，子线程也会退出，但是试了一下不行。<br>考虑通过在OnApplicationQuit事件中，调用Abort()方法来退出线程，试了一下依旧不行，在退出主线程后，子线程依旧执行。</p>
<p><img src="/img/thread2.png" alt="&quot;Unity3D多线程&quot;">  </p>
<p>试了一下，在子线程循环中开启Thread.Sleep(一个很短的时间)，abort终止线程便生效。但这种方法肯定不可取。如图：  </p>
<p><img src="/img/thread3.png" alt="&quot;Unity3D多线程&quot;">  </p>
<p>再测试了通过bool变量来控制线程的执行，可取，如下代码：  </p>
<pre><code><span class="keyword">bool</span> isQuit = <span class="literal">false</span>;
<span class="keyword">public</span> <span class="keyword">int</span> maxValue = <span class="number">10000</span>;
Thread aThread;
<span class="function"><span class="keyword">void</span> <span class="title">Awake</span><span class="params">()</span>
</span>{
    Debug.Log(<span class="string">"awake trigger!"</span>);
}

<span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span>
</span>{
    Debug.Log(<span class="string">"start trigger!"</span>);
    aThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(DoPrint));        
    aThread.Start();
}

<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DoPrint</span><span class="params">()</span>
</span>{
    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxValue; i++)<span class="comment">//子线程执行完后其IsAlive属性变成false</span>
    {
        <span class="keyword">if</span> (isQuit)
        {
            <span class="keyword">return</span>;
        }
        Debug.Log(<span class="string">"value is:"</span> + i);
    }
}

<span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span>
</span>{
    Debug.Log(<span class="string">"update trigger!"</span>);
}

<span class="function"><span class="keyword">void</span> <span class="title">OnApplicationQuit</span><span class="params">()</span>
</span>{
    <span class="keyword">if</span> (aThread.IsAlive)
    {
        isQuit = <span class="literal">true</span>;
        Debug.Log(<span class="string">"aThread is still alive,you quit and abort"</span>);            
    }
    <span class="keyword">else</span>
    {
        Debug.Log(<span class="string">"aThread is null,you quit"</span>);
    }
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ogg格式转换" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/ogg格式转换/" class="article-date">
  	<time datetime="2016-03-06T07:25:17.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/ogg格式转换/">ogg、ogv格式转换</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1_在线工具">1 在线工具</h1><p><a href="http://www.online-convert.com/" target="_blank" rel="external">http://www.online-convert.com/</a></p>
<h1 id="2_TheoraConverter">2 TheoraConverter</h1><p>老软件了，好几年没有更新了。<br><http: sourceforge.net="" projects="" theoraconverter="">可以下载到1.1版本的，貌似没有格式选择，测试了一下转换后为ogv格式的。<br><http: theora-converter-net.software.informer.com="" download="">这里提供的有2.6版本的，但是下载不下<br>2.6版本的多了格式选择，其它的没有详细比较。。。</http:></http:></p>
<p>我的网盘提供了1.1，2.6两个版本的 <a href="http://pan.baidu.com/s/1mhqFPri" target="_blank" rel="external">http://pan.baidu.com/s/1mhqFPri</a>  </p>
<p><img src="/img/TheoraConverter v2.6.png" alt="&quot;TheoraConverter使用截图&quot;">  </p>
<p>如图为2.6的截图，第二个选项卡“Video”里面EncodingMode默认就是Bitrate 1000<br>若用默认值，转出来的视频马赛克严重，故该值越大越好，范围为后面小括号内的值。<br>另外也可以选择Quality，默认值是6，测试结果还可以。这个值越大越清晰，当然视频的大小也会大一些。。。</p>
<h1 id="3：_iDealshare_VideoGo">3： iDealshare VideoGo</h1><p>这个没有测试，！！！蛋疼  </p>
<p><a href="http://www.idealshare.net/video-converter/ogv-converter-for-mac-windows.html" target="_blank" rel="external">http://www.idealshare.net/video-converter/ogv-converter-for-mac-windows.html</a></p>
<h1 id="4:vcl视频播放软件和miro_Video_Conterter软件">4:vcl视频播放软件和miro Video Conterter软件</h1><p><a href="http://www.videolan.org/" target="_blank" rel="external">http://www.videolan.org/</a>  </p>
<p><a href="http://www.mirovideoconverter.com/" target="_blank" rel="external">http://www.mirovideoconverter.com/</a>  </p>
<p>经过测试vcl和miro converter转换后的ogg（ogv）分辨率不行而且丢帧严重</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/沙里淘金/">沙里淘金</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-DontDestroyOnLoad" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/06/DontDestroyOnLoad/" class="article-date">
  	<time datetime="2016-03-06T07:17:27.000Z" itemprop="datePublished">2016-03-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/06/DontDestroyOnLoad/">DontDestroyOnLoad</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>该方法可以保证在跳转场景的时候不销毁某个物体。<br>比如场景A，场景B，场景A中有一个cube，通过在cube上添加脚本DontDestroyOnLoad,使得从A场景跳转到B场景的时候cube依旧在B场景中。这样就带来一个问题，当再次进入A场景的时候便会有两个cube，如此反复导致意外的事情。  </p>
<p>解决方法如下：  </p>
<pre><code>void Awake<span class="params">()</span>
{

    DontDestroyOnLoad<span class="params">(this)</span>;

    <span class="keyword">if</span> <span class="params">(FindObjectsOfType<span class="params">(GetType<span class="params">()</span>)</span>.Length &gt; <span class="number">1</span>)</span>
    {
        Destroy<span class="params">(gameObject)</span>;
    }
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Unity3D优化相关总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/05/Unity3D优化相关总结/" class="article-date">
  	<time datetime="2016-03-05T14:22:19.000Z" itemprop="datePublished">2016-03-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/05/Unity3D优化相关总结/">Unity3D优化相关总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>以下所有内容来自网络和个人日常学习、工作总结。欢迎交流：546722522</p>
<h1 id="Google_IO_2014_Unity游戏优化">Google_IO_2014_Unity游戏优化</h1><p>很好的一个国外Unity优化指南，提供了一些更深层次的优化指南。<br>PPT下载地址：<a href="http://pan.baidu.com/s/1hreCzoo" target="_blank" rel="external">http://pan.baidu.com/s/1hreCzoo</a></p>
<p>GPU瓶颈可以根据GPU类型选择合适的工具来进行分析：<br><img src="/img/gpu tools.png" alt="&quot;GPU分析工具&quot;">  </p>
<p>CPU时间衡量：<br>通过Profiler检查Camera.Render的时间<br>创建脚本，使用OnPreCull、OnPostRender、OnGUI来具体分析<br>OnPreCull是时间戳的开始、OnPostRender是时间戳的结束、OnGUI用来显示结果</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="posts-Unity3D 图片格式和出包大小之间的关系" class="article article-type-posts" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/12/Unity3D 图片格式和出包大小之间的关系/" class="article-date">
  	<time datetime="2015-10-11T16:56:33.908Z" itemprop="datePublished">2015-10-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/12/Unity3D 图片格式和出包大小之间的关系/">Unity3D 图片格式和出包大小之间的关系</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文以PC平台说明。所用素材为:<a href="http://pan.baidu.com/s/1sOuK2/" target="_blank" rel="external">http://pan.baidu.com/s/1sOuK2/</a></p>
<h1 id="情况一:">情况一:</h1><p>一张jpg图片分辨率1024*768，在PC上占用的空间为762KB。<br>复制50张。  </p>
<h2 id="1：放到StreamingAssets目录下">1：放到StreamingAssets目录下</h2><p>打包后，50张图在生成的包的StreamingAssets目录下，且每个图片的空间为762KB。<br>StreamingAssets目录大小为37.2MB。即没有压缩、没有二进制打包。StreamingAssets目录下的保持原样。在Unity中改变图片的纹理压缩格式，对打出的包的大小没有影响，即只和原始格式有关。</p>
<h2 id="2：放到Resources目录下">2：放到Resources目录下</h2><p>图片的纹理格式为RGB ETC1 4bit时，每个图占用内存384KB（逐像素算，不同于外存中图片大小的算法）。384*50=19200<br>再看最终resources.assets文件大小为19208KB（18.7MB）。即约等于每个图片的内存大小之和。</p>
<h1 id="情况二:">情况二:</h1><p>对该jpg图片进行压缩。<br>本人使用Sage Thumbs的右键快捷方式：转换为jpg，把50个图片转换了一下（保持尺寸不变），每个图片在PC的存储空间从762KB变成184KB。<br>再放到StreamingAssets下打包,StreamingAssets包的大小变为8.99MB。<br>放到resources目录下打包，依旧使用RGB ETC1 4bit。最终结果依旧为19208KB（18.7MB）。  </p>
<p>综上：图片若是放在StreamingAssets目录下，尽量减少图片的占用空间，从而减少包的尺寸。<br>Resources目录下打包，图片最终占用空间和其最终运行时占用的内存一致，即跟其纹理压缩格式有关。另外Resources目录打包后是以二进制格式保存的，比较安全。</p>
<h1 id="情况三:">情况三:</h1><p>打assetbundle<br>回到每张图外存762KB的情况，使用RGB ETC1 4bit （每个图384KB）的纹理压缩格式。对每个图打成assetbundle，每个assetbundle大小为200KB。<br>再使用RGB 16bit（每个图占用1.5MB）的纹理压缩格式，每个图的assetbundle大小为470KB。<br>再使用RGB 16bit的纹理压缩格式，再把图片外存改成184KB（按照上述情况二所述），打出的assetbundle大小为582KB。</p>
<p>综上：可见assetbundle大小也和纹理压缩格式有关，纹理压缩格式占用空间越大，bundle也越大。相对来说assetbundle在纹理压缩的基础上还进一步压缩了，从而减少大小。<br>另外和原始外存压缩格式也有关，具体关系本人也没有深究。<br>由于assetbundle一般不放到Resources目录下，所以这里不讨论放到Resources目录下的情况。<br>（实际上我也测试了一下，把assetbundle单独放到Resources目录下，打出的包没有resources.assets这个文件）</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/查漏补缺/">查漏补缺</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 bbbbbbion
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>